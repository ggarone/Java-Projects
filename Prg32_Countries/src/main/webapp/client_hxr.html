<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input type="text" name="" id="nomeStato" placeholder="Scrivi qui il nome di uno stato">
    <button>wawa</button>

    <form action="countries" method="post">
        <input type="text" id="nome" name="stato" placeholder="nome stato">
        <input type="text" id="capitale" name="capitale" placeholder="nome capitale">
        <input type="text" id="bandiera" name="bandiera" placeholder="url bandiera">
        <input type="text" id="popolazione" name="popolazione" placeholder="numero popolazione">
    </form>

    <h1 id="nome"></h1>
    <h2 id="popolazione"></h2>
    <ul id="fattiPrincipali"></ul>









    <script>
        const INPUT = document.getElementById('nomeStato');
        let PAESE = "italy";
        const URL ="https://restcountries.com/v3.1/name/";
        const xhr = new XMLHttpRequest();
        const NOME = document.getElementById('nome');
        const POP = document.getElementById('popolazione');
        const BANDIERA = document.getElementById('fattiPrincipali');
        const POPOLAZIONE = document.getElementById('fattiPrincipali');
        const FATTI = document.getElementById('fattiPrincipali');
        
        INPUT.onchange = function(){
            PAESE = INPUT.value;
            xhr.open('GET',URL+PAESE);
            xhr.onreadystatechange = (e =>{
                // console.log(e.target);
                // console.log(e.target.readyState);
                // console.log(e.target.status);
                if(e.target.readyState == 4 && e.target.status == 200){
                    console.log('abbiamo l\'oggetto');
                    // console.log(e.target.response);
                    let collezioneStati = JSON.parse(e.target.response);
                    let stato = collezioneStati[0];
                    console.log(stato.name.common);
                    console.log(stato);

                    NOME.textContent = stato.name.common + " [" + stato.name.official + "]";
                    POP.textContent = stato.population;

                    FATTI.innerHTML += '<li>' + stato.capital + '</li>';
            }
        });
        xhr.send();
        }

        xhr.open('GET',URL+URL_EUROPE);
        xhr.onreadystatechange = (e =>{
            // console.log(e.target);
            // console.log(e.target.readyState);
            // console.log(e.target.status);
            if(e.target.readyState == 4 && e.target.status == 200){
                console.log('abbiamo l\'oggetto');
                // console.log(e.target.response);
                let collezioneStati = JSON.parse(e.target.response);
                for (const state of collezioneStati) {
                    const LINK = document.createElement('a');
                    LINK.setAttribute('onlick','trovaPaese('+state.name.common+')');
                    LINK.textContent = state.name.common;
                    const LI = document.createElement('li');
                    LI.appendChild(LINK);
                    FATTI.appendChild(LI);
                    console.log(stato.name.common);
                    
                }
            }
        });
        xhr.send();




    

    </script>
</body>
</html>